{"version":3,"file":"stage-fright.js","sources":["../../src/js/lib/structure.js","../../src/js/lib/state/pubsub.js","../../src/js/lib/state/store.js","../../src/js/lib/state/mutations.js","../../src/js/lib/state/actions.js","../../src/js/lib/display/translate.js","../../src/js/lib/display/fragments.js","../../src/js/lib/navigation/hash.js","../../src/js/lib/navigation/history.js","../../src/js/lib/init.js","../../src/js/stage-fright.js"],"sourcesContent":["class StageFrightNode {\n  constructor(item) {\n    this.elem = item;\n    this.previous = null;\n    this.next = null;\n    this.first = false;\n    this.notes = null;\n\n    if (item.classList.contains('_stage--slide')) {\n      this.type = 'slide';\n\n      if (item.parentNode.firstElementChild === item) {\n        this.first = true;\n      }\n    } else if (item.classList.contains('fragment')) {\n      this.type = 'fragment';\n    }\n\n    const notes = item.querySelector('._stage--notes');\n    if (notes) {\n      this.notes = notes.innerHTML;\n    }\n  }\n}\n\nexport class StageFrightList {\n  constructor() {\n    this._head = null;\n    this._tail = null;\n    this._length = 0;\n    this._depth = 0;\n\n    this._sectionHolder = -1;\n    this._depthHolder = 0;\n    this._fragmentHolder = 0;\n    this._fragmentDepth = [];\n  }\n\n  add(item) {\n    const node = new StageFrightNode(item);\n    let current = this._head;\n\n    if (node.first) {\n      this._sectionHolder++;\n      if (this._depthHolder > this._depth) {\n        this._depth = this._depthHolder;\n      }\n      this._depthHolder = 0;\n    } else if (node.type !== 'fragment') {\n      this._depthHolder++;\n    }\n\n    if (node.type !== 'fragment') {\n      if (this._fragmentHolder !== 0) {\n        this._fragmentDepth.push(this._fragmentHolder);\n        this._fragmentHolder = 0;\n      }\n    } else {\n      this._fragmentHolder++;\n      node.fragment = this._fragmentHolder;\n    }\n\n    node.section = this._sectionHolder;\n    node.depth = this._depthHolder;\n    node.previous = this._tail;\n    this._length++;\n\n    if (node.type === 'slide') {\n      node.number = this._length - 1;\n    }\n\n    // If there isn't a head, make head, tail, and current our node! then increase the length;\n    if (!current) {\n      this._head = node;\n      this._tail = node;\n      return node;\n    }\n\n    // If there is a current, update the tail\n    this._tail.next = node;\n    this._tail = node;\n\n    if (node.type === 'fragment' && node.previous.type !== 'fragment') {\n      node.previous.fragment = 0;\n    }\n\n    if (node.type === 'fragment' && node.previous.notes) {\n      node.notes = node.previous.notes;\n    }\n\n    return node;\n  }\n\n  find(index) {\n    index = parseInt(index);\n\n    if (index > this._length - 1 || index < 0) {\n      return false;\n    }\n\n    // First\n    if (index === 0) {\n      return this._head;\n    }\n\n    // Last\n    if (index === this._length - 1) {\n      return this._tail;\n    }\n\n    // Start from the end or the beginning?\n    const headToTail = index <= Math.floor(this._length / 2);\n    let current = this._head;\n    let i = 1;\n\n    if (headToTail) {\n      do {\n        current = current.next;\n        i++;\n      } while (i <= index);\n    } else {\n      current = this._tail;\n      i = this._length - 2;\n\n      do {\n        current = current.previous;\n        i--;\n      } while (i >= index);\n    }\n\n    return current;\n  }\n\n  forEach(cb) {\n    let current = this._head;\n    let i = 0;\n    while (current.next) {\n      cb(current, i);\n      current = current.next;\n      i++;\n    }\n\n    cb(current);\n  }\n\n  updateFragments() {\n    const fragTotals = this._fragmentDepth.reverse();\n    let currentFrag = fragTotals.pop();\n    this.forEach(item => {\n      if (item.hasOwnProperty('fragment')) {\n        item.totalFragments = currentFrag;\n\n        if (item.next.type !== 'fragment') {\n          currentFrag = fragTotals.pop();\n        }\n      }\n    });\n  }\n\n  buildProgress(store, createMinimapLink) {\n    this.forEach((item, i) => {\n      if (item.type === 'slide') {\n        if (typeof i === 'undefined') {\n          i = this._length - 1;\n        }\n\n        item.progress = createMinimapLink(\n          i,\n          item.section,\n          item.depth,\n          item.hasOwnProperty('fragment'),\n        );\n      } else {\n        item.progress = item.previous.progress;\n      }\n    });\n  }\n}\n","export default class PubSub {\n  constructor() {\n    this.events = {};\n  }\n\n  subscribe(event, cb) {\n    if (!this.events[event]) {\n      this.events[event] = [];\n    }\n\n    return this.events[event].push(cb);\n  }\n\n  publish(event, data = {}) {\n    if (!this.events[event]) {\n      return [];\n    }\n\n    return this.events[event].map(cb => cb(data));\n  }\n}\n","import PubSub from './pubsub.js';\n\nexport default class Store {\n  constructor(params = {}) {\n    const self = this;\n\n    this.actions = params.actions || {};\n    this.mutations = params.mutations || {};\n    this.status = 'resting';\n    this.changes = new PubSub();\n    this.stage = params.stage || {};\n    this.progress = params.progress || [];\n    this.root = params.root || document.body;\n    this.help = params.help || false;\n    this.overview = params.overview || false;\n    this.broadcast = params.broadcast || true;\n\n    this.state = new Proxy(params.state || {}, {\n      set(state, key, value) {\n        state[key] = value;\n\n        if (self.status !== 'mutation') {\n          console.warn(`You should use a mutation to set ${key}`);\n        }\n\n        self.changes.publish(`${key}`, self.state);\n        self.changes.publish('stateChange', self.state);\n\n        return true;\n      },\n    });\n  }\n\n  dispatch(action, payload, ...options) {\n    if (typeof this.actions[action] !== 'function') {\n      console.error(`Action \"${action}\" doesn't exist`);\n      return false;\n    }\n\n    this.status = 'action';\n\n    this.actions[action](this, payload, options);\n\n    return true;\n  }\n\n  async commit(mutation, payload, ...options) {\n    if (typeof this.mutations[mutation] !== 'function') {\n      console.error(`Mutation \"${mutation}\" doesn't exist`);\n      return false;\n    }\n\n    this.status = 'mutation';\n\n    let newState = this.mutations[mutation](Object.assign({}, this.state), payload, options);\n\n    if ('then' in newState) {\n      newState = await newState;\n      this.state = Object.assign(this.state, newState);\n    } else {\n      this.state = Object.assign(this.state, newState);\n    }\n\n    return true;\n  }\n}\n","export default {\n  navigate(state, payload, options) {\n    // console.log(options);\n    if (payload === 'next' && state.current.next) {\n      state.current = state.current.next;\n      state.index += 1;\n    } else if (payload === 'previous' && state.current.previous) {\n      state.current = state.current.previous;\n      state.index -= 1;\n    } else if (payload !== 'next' && payload !== 'previous') {\n      state.current = payload;\n    }\n\n    state.overview = false;\n\n    if (options[0] === false) {\n      state.broadcast = false;\n    } else {\n      state.broadcast = true;\n    }\n\n    return state;\n  },\n  index(state, payload) {\n    state.index = payload;\n\n    return state;\n  },\n  progress(state, payload) {\n    const previous = state.progress;\n    state.progress = state.current.progress;\n\n    if (state.progress) {\n      if (previous && previous !== state.progress && previous.dataset.hasOwnProperty('active')) {\n        delete previous.dataset.active;\n      }\n\n      state.progress.dataset.active = true;\n\n      if (state.current.hasOwnProperty('fragment')) {\n        if (state.current.fragment === state.current.totalFragments) {\n          state.progress.dataset.fragments = false;\n        } else {\n          state.progress.dataset.fragments = true;\n        }\n      }\n    }\n\n    return state;\n  },\n  async notes(state, { root, length }) {\n    if (state.presentation.channel) {\n      if (!state.presentation.notes) {\n        const url = new URL(window.location.toString());\n        const params = new URLSearchParams(url.search.slice(1));\n        params.append('display', true);\n        url.search = `?${params}`;\n\n        state.presentation.window = window.open(\n          url.toString(),\n          null,\n          'menubar=0,toolbar=0,location=0,dependent=1,fullscreen=1,left-0,top=0',\n        );\n\n        const { notesBody, updateNotes } = await import('../presentation');\n        const builtNotes = notesBody(state.index, state.current);\n        root.parentNode.insertBefore(builtNotes._notes, root);\n        root.dataset.hidden = true;\n        root.parentNode.dataset.notes = true;\n        updateNotes(builtNotes, state.index, state.current);\n        builtNotes.total.textContent = length - 1;\n        state.presentation.notes = builtNotes;\n\n        // TODO reset notes when popup closed\n        // state.presentation.window.addEventListener('unload', () => {\n        //   setTimeout(() => {\n        //     if (state.presentation.window.closed) {\n        //       console.log('Closed!');\n        //     }\n        //   }, 500);\n        //   // store.dispatch('notes', 'toggle');\n        // });\n      } else {\n        root.parentNode.removeChild(state.presentation.notes._notes);\n        delete root.dataset.hidden;\n        delete root.parentNode.dataset.notes;\n        state.presentation.notes = null;\n        state.presentation.window.close();\n      }\n    }\n\n    return state;\n  },\n  display(state, payload) {\n    if (state.display === 'presentation') {\n      state.display = 'article';\n    } else {\n      state.display = 'presentation';\n    }\n\n    return state;\n  },\n  toggle(state, payload) {\n    state[payload] = !state[payload];\n\n    return state;\n  },\n};\n","export default {\n  navigate(context, payload, options) {\n    // console.log(options);\n    if (payload === 'next' || payload === 'previous') {\n      context.commit('navigate', payload, options[0]);\n    } else {\n      const found = context.stage.find(payload, options[0]);\n      context.commit('navigate', found, options[0]);\n      context.commit('index', payload, options[0]);\n    }\n\n    if (!context.embedded) {\n      context.commit('progress', 'toggle');\n    }\n  },\n  notes(context, payload) {\n    // console.log('Notes');\n    // console.log(payload);\n    context.commit('notes', { root: context.root, length: context.stage._length });\n  },\n  display(context, payload) {\n    context.commit('display', payload);\n  },\n  toggle(context, payload) {\n    context.commit('toggle', payload);\n  },\n};\n","export default function(root, current) {\n  const transform = `translate(${-100 * current.section}vw) translateY(${-100 * current.depth}vh)`;\n  root.style.transform = transform;\n}\n","export default function(current) {\n  let active = false;\n\n  // Make the current fragment active (only will happen on _next_)\n  if (current.type === 'fragment') {\n    const dataset = current.elem.dataset;\n    if (!dataset.hasOwnProperty('active') || dataset.active === 'false') {\n      dataset.active = true;\n\n      let previous = current.previous;\n\n      while (previous && previous.type === 'fragment') {\n        previous.elem.dataset.active = true;\n        previous = previous.previous;\n      }\n      \n      active = true;\n    }  \n  }\n\n  // Make the next fragment inactive if we didn't make the current one active\n  if (active === false && current.next && current.next.type === 'fragment') {\n    delete current.next.elem.dataset.active;\n  }\n}\n","export default function(max) {\n  const starter = new URL(window.location);\n  let pos = 0;\n\n  if (starter.hash) {\n    pos = parseInt(starter.hash.split('/')[1]);\n  }\n\n  if (pos < 0) {\n    pos = 0;\n  } else if (pos > max) {\n    pos = max;\n  }\n\n  return pos;\n}\n","export default function updateHistory(index) {\n  history.pushState(null, null, `#/${index}`);\n}\n","import { StageFrightList } from './structure';\n\nimport Store from './state/store';\nimport mutations from './state/mutations';\nimport actions from './state/actions';\n\nimport translate from './display/translate';\nimport fragments from './display/fragments';\n\nimport navHash from './navigation/hash';\nimport updateHistory from './navigation/history';\n\nimport { createPresentation } from './presentation';\n\nexport default class StageFright {\n  constructor(root, options = { spacebar: true, remote: true }) {\n    const rootNode = document.querySelector(root);\n    // Make the Stage Fright Stage\n    rootNode.parentNode.classList.add('stage-fright');\n\n    const items = Array.from(rootNode.querySelectorAll('._stage--slide, .fragment'));\n\n    // Stage\n    const stage = new StageFrightList();\n    items.forEach(item => {\n      stage.add(item);\n    });\n    stage.updateFragments();\n\n    const embedded = new URLSearchParams(window.location.search).get('embedded') === 'true';\n\n    const upcoming = new URLSearchParams(window.location.search).get('upcoming') === 'true';\n\n    const display = new URLSearchParams(window.location.search).get('display') === 'true';\n\n    if (embedded) {\n      rootNode.parentNode.classList.add('embedded');\n    }\n\n    if (display) {\n      rootNode.parentNode.classList.add('display');\n      options._display = true;\n    } else {\n      options._display = false;\n    }\n\n    // Starting Index\n    const start = navHash(stage.length - 1);\n\n    // Set up state and store\n    this.store = new Store({\n      actions,\n      mutations,\n      progress: 'foo',\n      state: {\n        current: stage._head,\n        progress: null,\n        index: start,\n        notes: false,\n        presentation: createPresentation(),\n        display: 'presentation',\n        help: false,\n        broadcast: true,\n      },\n      stage,\n      embedded,\n      display,\n      root: rootNode,\n    });\n\n    this.store.changes.subscribe('current', async state => {\n      translate(rootNode, state.current);\n      fragments(state.current);\n    });\n\n    this.store.changes.subscribe('index', async state => {\n      updateHistory(state.index);\n      if (state.broadcast && state.presentation.channel) {\n        state.presentation.channel.postMessage(state.index);\n      }\n\n      if (state.presentation.notes) {\n        const { updateNotes } = await import('./presentation');\n        updateNotes(state.presentation.notes, state.index, state.current);\n      }\n    });\n\n    this.store.changes.subscribe('display', state => {\n      if (state.display === 'presentation') {\n        rootNode.parentNode.classList.add('stage-fright');\n        document.body.scrollTop = document.documentElement.scrollTop = 0;\n      } else {\n        rootNode.parentNode.classList.remove('stage-fright');\n      }\n    });\n\n    this.store.changes.subscribe('presentation', async state => {\n      if (state.presentation.connection) {\n        const { advancePresentation } = await import('./presentation');\n\n        state.presentation.connection.addEventListener('message', e => {\n          const message = JSON.parse(e.data);\n\n          if (message.start) {\n            advancePresentation(state.presentation.connection, state.index);\n          }\n\n          if (message.goto !== state.index) {\n            this.goto(message.goto);\n          }\n        });\n      }\n    });\n\n    if (this.store.state.presentation.channel) {\n      this.store.state.presentation.channel.onmessage = e => {\n        if (upcoming) {\n          this.goto(e.data + 1, false);\n        } else {\n          this.goto(e.data, false);\n        }\n      };\n    }\n\n    this.store.changes.subscribe('overview', state => {\n      const scale = stage._sectionHolder > stage._depth ? stage._sectionHolder : stage._depth;\n\n      let transform = `scale(${1 / (scale + 1)})`;\n      const diff = Math.abs(stage._depth - stage._sectionHolder);\n\n      if (scale === stage._depth) {\n        transform += `translateX(-${50 * (scale - diff)}vw) translateY(-${50 * scale}vh)`;\n      } else {\n        transform += `translateX(-${50 * scale}vw) translateY(-${50 * (scale - diff)}vh)`;\n      }\n\n      if (state.overview) {\n        // TODO: Make keyboard accessible\n        rootNode.style.transform = transform;\n        stage.forEach(item => {\n          if (item.type === 'slide') {\n            item.elem.style.cursor = 'pointer';\n            item.elem.addEventListener('click', e => {\n              e.preventDefault();\n              e.stopPropagation();\n              this.goto(item.number);\n            });\n          }\n        });\n      } else {\n        stage.forEach(item => {\n          item.elem.style.cursor = 'initial';\n        });\n      }\n    });\n\n    // Look how awesome this upgrade is now\n    if (!embedded) {\n      this.upgrade(stage, rootNode, start, options);\n    } else {\n      this.goto(start);\n    }\n\n    // Set up progress\n    window.addEventListener('hashchange', () => {\n      const pos = navHash(stage.length - 1);\n      this.goto(pos);\n    });\n\n    import('./lazyload').then(({ default: lazyload }) => lazyload());\n  }\n\n  async upgrade(stage, rootNode, start, options) {\n    if (!('requestIdleCallback' in window)) {\n      await import('requestidlecallback');\n    }\n\n    requestIdleCallback(\n      async () => {\n        try {\n          const { upgrade } = await import('./upgrade');\n          upgrade.bind(this)(stage, rootNode, start, options);\n        } catch (e) {\n          console.error(e);\n        }\n      },\n      { timeout: 500 },\n    );\n  }\n\n  next() {\n    this.store.dispatch('navigate', 'next');\n  }\n\n  previous() {\n    this.store.dispatch('navigate', 'previous');\n  }\n\n  goto(slide, broadcast = true) {\n    this.store.dispatch('navigate', slide, broadcast);\n  }\n}\n","import StageFright from './lib/init.js';\n\nwindow.addEventListener('DOMContentLoaded', () => {\n  const stage = new StageFright('._stage');\n  window.stage = stage;\n});\n"],"names":["StageFrightNode","constructor","item","elem","previous","next","first","notes","classList","contains","type","parentNode","firstElementChild","querySelector","innerHTML","StageFrightList","_head","_tail","_length","_depth","_sectionHolder","_depthHolder","_fragmentHolder","_fragmentDepth","add","node","current","push","fragment","section","depth","number","find","index","parseInt","headToTail","Math","floor","i","forEach","cb","updateFragments","fragTotals","reverse","currentFrag","pop","hasOwnProperty","totalFragments","buildProgress","store","createMinimapLink","progress","PubSub","events","subscribe","event","publish","data","map","Store","params","self","actions","mutations","status","changes","stage","root","document","body","help","overview","broadcast","state","Proxy","set","key","value","console","warn","dispatch","action","payload","options","error","commit","mutation","newState","Object","assign","navigate","dataset","active","fragments","length","presentation","channel","url","URL","window","location","toString","URLSearchParams","search","slice","append","open","notesBody","updateNotes","builtNotes","insertBefore","_notes","hidden","total","textContent","removeChild","close","display","toggle","context","found","embedded","transform","style","max","starter","pos","hash","split","updateHistory","history","pushState","StageFright","spacebar","remote","rootNode","items","Array","from","querySelectorAll","get","upcoming","_display","start","navHash","createPresentation","translate","postMessage","scrollTop","documentElement","remove","connection","advancePresentation","addEventListener","e","message","JSON","parse","goto","onmessage","scale","diff","abs","cursor","preventDefault","stopPropagation","upgrade","then","default","lazyload","requestIdleCallback","bind","timeout","slide"],"mappings":"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"}