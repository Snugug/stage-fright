{"version":3,"file":"lazyload.js","sources":["../../src/js/lib/lazyload.js"],"sourcesContent":["export function removeLazyLoading(e) {\n  e.target.removeAttribute('data-lazy-loading');\n}\n\nexport function loadImage(elem) {\n  let loading = elem;\n  let load = false;\n\n  if (elem.tagName === 'PICTURE') {\n    const sets = elem.querySelectorAll('[data-srcset]');\n    const srcs = elem.querySelectorAll('[data-src]');\n\n    sets.forEach((set) => {\n      load = true;\n      set.srcset = set.dataset.srcset; // eslint-disable-line no-param-reassign\n      delete set.dataset.srcset; // eslint-disable-line no-param-reassign\n    });\n\n    srcs.forEach((src) => {\n      load = true;\n      src.src = src.dataset.src; // eslint-disable-line no-param-reassign\n      delete src.dataset.src; // eslint-disable-line no-param-reassign\n    });\n  } else if (elem.tagName === 'IMG') {\n    if (elem.dataset.src) {\n      load = true;\n      elem.src = elem.dataset.src; // eslint-disable-line no-param-reassign\n      delete elem.dataset.src; // eslint-disable-line no-param-reassign\n    }\n  }\n\n  if (load) {\n    loading.setAttribute('data-lazy-loading', true);\n    loading.addEventListener('load', removeLazyLoading);\n  }\n}\n\nexport function loadMedia(elem) {\n  let loading = elem;\n  let load = false;\n\n  if (elem.dataset.src) {\n    load = true;\n    loading.src = loading.dataset.src;\n    delete loading.dataset.src;\n  } else {\n    const srcs = elem.querySelectorAll('[data-src]');\n    srcs.forEach((src) => {\n      load = true;\n      src.src = src.dataset.src;\n      delete src.dataset.src;\n    });\n  }\n\n  loading.preload = 'auto';\n\n  if (load) {\n    loading.setAttribute('data-lazy-loading', true);\n    loading.addEventListener('loadeddata', removeLazyLoading);\n  }\n}\n\nexport function loadMultimediaObserver(entries) {\n  entries.forEach((entry) => {\n    if (entry.isIntersecting) {\n      const target = entry.target;\n\n      if (target.tagName === 'IMG' || target.targetName === 'PICTURE') {\n        loadImage(target);  \n      } else {\n        loadMedia(target);\n      }\n    }\n  });\n}\n\nexport default function () {\n  const multimedia = document.querySelectorAll('picture, img, video, audio, iframe');\n\n  if ('IntersectionObserver' in window) {\n    const observer = new IntersectionObserver(loadMultimediaObserver);\n    multimedia.forEach(m => observer.observe(m));\n  } else {\n    multimedia.forEach((m) => {\n      if (m.tagName === 'IMG' || m.tagName === 'PICTURE') {\n        loadImage(m);\n      } else {\n        loadMedia(m)\n      }\n    });\n  }\n}\n"],"names":["removeLazyLoading","e","target","removeAttribute","loadImage","elem","loading","load","tagName","sets","querySelectorAll","srcs","forEach","set","srcset","dataset","src","setAttribute","addEventListener","loadMedia","preload","loadMultimediaObserver","entries","entry","isIntersecting","targetName","multimedia","document","window","observer","IntersectionObserver","m","observe"],"mappings":"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"}