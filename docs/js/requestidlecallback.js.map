{"version":3,"file":"requestidlecallback.js","sources":["../../node_modules/requestidlecallback/index.js"],"sourcesContent":["(function (factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine([], factory);\n\t} else if (typeof module === 'object' && module.exports) {\n\t\tmodule.exports = factory();\n\t} else {\n\t\twindow.idleCallbackShim = factory();\n\t}\n}(function(){\n\t'use strict';\n\tvar scheduleStart, throttleDelay, lazytimer, lazyraf;\n\tvar root = typeof window != 'undefined' ?\n\t\twindow :\n\t\ttypeof global != undefined ?\n\t\t\tglobal :\n\t\t\tthis || {};\n\tvar requestAnimationFrame = root.cancelRequestAnimationFrame && root.requestAnimationFrame || setTimeout;\n\tvar cancelRequestAnimationFrame = root.cancelRequestAnimationFrame || clearTimeout;\n\tvar tasks = [];\n\tvar runAttempts = 0;\n\tvar isRunning = false;\n\tvar remainingTime = 7;\n\tvar minThrottle = 35;\n\tvar throttle = 125;\n\tvar index = 0;\n\tvar taskStart = 0;\n\tvar tasklength = 0;\n\tvar IdleDeadline = {\n\t\tget didTimeout(){\n\t\t\treturn false;\n\t\t},\n\t\ttimeRemaining: function(){\n\t\t\tvar timeRemaining = remainingTime - (Date.now() - taskStart);\n\t\t\treturn timeRemaining < 0 ? 0 : timeRemaining;\n\t\t},\n\t};\n\tvar setInactive = debounce(function(){\n\t\tremainingTime = 22;\n\t\tthrottle = 66;\n\t\tminThrottle = 0;\n\t});\n\n\tfunction debounce(fn){\n\t\tvar id, timestamp;\n\t\tvar wait = 99;\n\t\tvar check = function(){\n\t\t\tvar last = (Date.now()) - timestamp;\n\n\t\t\tif (last < wait) {\n\t\t\t\tid = setTimeout(check, wait - last);\n\t\t\t} else {\n\t\t\t\tid = null;\n\t\t\t\tfn();\n\t\t\t}\n\t\t};\n\t\treturn function(){\n\t\t\ttimestamp = Date.now();\n\t\t\tif(!id){\n\t\t\t\tid = setTimeout(check, wait);\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction abortRunning(){\n\t\tif(isRunning){\n\t\t\tif(lazyraf){\n\t\t\t\tcancelRequestAnimationFrame(lazyraf);\n\t\t\t}\n\t\t\tif(lazytimer){\n\t\t\t\tclearTimeout(lazytimer);\n\t\t\t}\n\t\t\tisRunning = false;\n\t\t}\n\t}\n\n\tfunction onInputorMutation(){\n\t\tif(throttle != 125){\n\t\t\tremainingTime = 7;\n\t\t\tthrottle = 125;\n\t\t\tminThrottle = 35;\n\n\t\t\tif(isRunning) {\n\t\t\t\tabortRunning();\n\t\t\t\tscheduleLazy();\n\t\t\t}\n\t\t}\n\t\tsetInactive();\n\t}\n\n\tfunction scheduleAfterRaf() {\n\t\tlazyraf = null;\n\t\tlazytimer = setTimeout(runTasks, 0);\n\t}\n\n\tfunction scheduleRaf(){\n\t\tlazytimer = null;\n\t\trequestAnimationFrame(scheduleAfterRaf);\n\t}\n\n\tfunction scheduleLazy(){\n\n\t\tif(isRunning){return;}\n\t\tthrottleDelay = throttle - (Date.now() - taskStart);\n\n\t\tscheduleStart = Date.now();\n\n\t\tisRunning = true;\n\n\t\tif(minThrottle && throttleDelay < minThrottle){\n\t\t\tthrottleDelay = minThrottle;\n\t\t}\n\n\t\tif(throttleDelay > 9){\n\t\t\tlazytimer = setTimeout(scheduleRaf, throttleDelay);\n\t\t} else {\n\t\t\tthrottleDelay = 0;\n\t\t\tscheduleRaf();\n\t\t}\n\t}\n\n\tfunction runTasks(){\n\t\tvar task, i, len;\n\t\tvar timeThreshold = remainingTime > 9 ?\n\t\t\t9 :\n\t\t\t1\n\t\t;\n\n\t\ttaskStart = Date.now();\n\t\tisRunning = false;\n\n\t\tlazytimer = null;\n\n\t\tif(runAttempts > 2 || taskStart - throttleDelay - 50 < scheduleStart){\n\t\t\tfor(i = 0, len = tasks.length; i < len && IdleDeadline.timeRemaining() > timeThreshold; i++){\n\t\t\t\ttask = tasks.shift();\n\t\t\t\ttasklength++;\n\t\t\t\tif(task){\n\t\t\t\t\ttask(IdleDeadline);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(tasks.length){\n\t\t\tscheduleLazy();\n\t\t} else {\n\t\t\trunAttempts = 0;\n\t\t}\n\t}\n\n\tfunction requestIdleCallbackShim(task){\n\t\tindex++;\n\t\ttasks.push(task);\n\t\tscheduleLazy();\n\t\treturn index;\n\t}\n\n\tfunction cancelIdleCallbackShim(id){\n\t\tvar index = id - 1 - tasklength;\n\t\tif(tasks[index]){\n\t\t\ttasks[index] = null;\n\t\t}\n\t}\n\n\tif(!root.requestIdleCallback || !root.cancelIdleCallback){\n\t\troot.requestIdleCallback = requestIdleCallbackShim;\n\t\troot.cancelIdleCallback = cancelIdleCallbackShim;\n\n\t\tif(root.document && document.addEventListener){\n\t\t\troot.addEventListener('scroll', onInputorMutation, true);\n\t\t\troot.addEventListener('resize', onInputorMutation);\n\n\t\t\tdocument.addEventListener('focus', onInputorMutation, true);\n\t\t\tdocument.addEventListener('mouseover', onInputorMutation, true);\n\t\t\t['click', 'keypress', 'touchstart', 'mousedown'].forEach(function(name){\n\t\t\t\tdocument.addEventListener(name, onInputorMutation, {capture: true, passive: true});\n\t\t\t});\n\n\t\t\tif(root.MutationObserver){\n\t\t\t\tnew MutationObserver( onInputorMutation ).observe( document.documentElement, {childList: true, subtree: true, attributes: true} );\n\t\t\t}\n\t\t}\n\t} else {\n\t\ttry{\n\t\t\troot.requestIdleCallback(function(){}, {timeout: 0});\n\t\t} catch(e){\n\t\t\t(function(rIC){\n\t\t\t\tvar timeRemainingProto, timeRemaining;\n\t\t\t\troot.requestIdleCallback = function(fn, timeout){\n\t\t\t\t\tif(timeout && typeof timeout.timeout == 'number'){\n\t\t\t\t\t\treturn rIC(fn, timeout.timeout);\n\t\t\t\t\t}\n\t\t\t\t\treturn rIC(fn);\n\t\t\t\t};\n\t\t\t\tif(root.IdleCallbackDeadline && (timeRemainingProto = IdleCallbackDeadline.prototype)){\n\t\t\t\t\ttimeRemaining = Object.getOwnPropertyDescriptor(timeRemainingProto, 'timeRemaining');\n\t\t\t\t\tif(!timeRemaining || !timeRemaining.configurable || !timeRemaining.get){return;}\n\t\t\t\t\tObject.defineProperty(timeRemainingProto, 'timeRemaining', {\n\t\t\t\t\t\tvalue:  function(){\n\t\t\t\t\t\t\treturn timeRemaining.get.call(this);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tenumerable: true,\n\t\t\t\t\t\tconfigurable: true,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})(root.requestIdleCallback)\n\t\t}\n\t}\n\n\treturn {\n\t\trequest: requestIdleCallbackShim,\n\t\tcancel: cancelIdleCallbackShim,\n\t};\n}));\n"],"names":["factory","define","amd","module","exports","window","idleCallbackShim","scheduleStart","throttleDelay","lazytimer","lazyraf","root","global","undefined","requestAnimationFrame","cancelRequestAnimationFrame","setTimeout","clearTimeout","tasks","runAttempts","isRunning","remainingTime","minThrottle","throttle","index","taskStart","tasklength","IdleDeadline","didTimeout","timeRemaining","Date","now","setInactive","debounce","fn","id","timestamp","wait","check","last","abortRunning","onInputorMutation","scheduleLazy","scheduleAfterRaf","runTasks","scheduleRaf","task","i","len","timeThreshold","length","shift","requestIdleCallbackShim","push","cancelIdleCallbackShim","requestIdleCallback","cancelIdleCallback","document","addEventListener","forEach","name","capture","passive","MutationObserver","observe","documentElement","childList","subtree","attributes","timeout","e","rIC","timeRemainingProto","IdleCallbackDeadline","prototype","Object","getOwnPropertyDescriptor","configurable","get","defineProperty","value","call","enumerable","request","cancel"],"mappings":"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"}