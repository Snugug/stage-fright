{"version":3,"file":"presentation.js","sources":["../../src/js/lib/presentation.js"],"sourcesContent":["export function createPresentation() {\n  return {\n    channel: window.BroadcastChannel ? new BroadcastChannel('presentation') : null,\n  };\n}\n\nexport function buildNotesPreviewLink(index, upcoming = false) {\n  const locale = window.location;\n  const search = new URLSearchParams();\n  const link = new URL(locale.origin + locale.pathname);\n  link.hash = `#/${index}`;\n  search.set('embedded', true);\n  if (upcoming) {\n    search.set('upcoming', true);\n  }\n\n  link.search = search.toString();\n\n  return link.toString();\n}\n\nexport function updateNotes(notes, index, current) {\n  // Update Notes preview URLs on index change;\n  if (current.notes) {\n    notes.content.innerHTML = current.notes;\n  } else {\n    notes.content.innerHTML = '';\n  }\n\n  notes.index.textContent = index;\n\n  if (current.hasOwnProperty('fragment')) {\n    notes.fragments.dataset.active = true;\n    notes.currentFrag.textContent = current.fragment;\n    notes.totalFrag.textContent = current.totalFragments;\n  } else {\n    if (notes.fragments.dataset.hasOwnProperty('active')) {\n      delete notes.fragments.dataset.active;\n    }\n    notes.currentFrag.textContent = '';\n    notes.totalFrag.textContent = '';\n  }\n}\n\nexport function timing(parent) {\n  const clock = parent.querySelector('.clock--value');\n  const timer = parent.querySelector('.timer');\n  const hour = parent.querySelector('.timer--hours');\n  const minute = parent.querySelector('.timer--minutes');\n  const second = parent.querySelector('.timer--seconds');\n  let start = new Date();\n\n  // Update to begin\n  update();\n\n  // Update every second\n  let runningClock = setInterval(update, 1000);\n\n  timer.addEventListener('click', e => {\n    start = new Date();\n\n    clearInterval(runningClock);\n\n    hour.textContent = timePad(0);\n    minute.textContent = `:${timePad(0)}`;\n    second.textContent = `:${timePad(0)}`;\n\n    runningClock = setInterval(update, 1000);\n  });\n\n  function update() {\n    const now = new Date();\n\n    const diff = now.getTime() - start.getTime();\n    const hours = Math.floor(diff / (1000 * 60 * 60));\n    const minutes = Math.floor((diff / (1000 * 60)) % 60);\n    const seconds = Math.floor((diff / 1000) % 60);\n\n    clock.textContent = now.toLocaleTimeString('en-US', {\n      hour12: false,\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n    hour.textContent = timePad(hours);\n    minute.textContent = `:${timePad(minutes)}`;\n    second.textContent = `:${timePad(seconds)}`;\n\n    hour.setAttribute('data-mute', hours <= 0);\n    minute.setAttribute('data-mute', minutes <= 0);\n  }\n\n  function timePad(time) {\n    const str = `00${parseInt(time)}`;\n    return str.substring(str.length - 2);\n  }\n}\n\nexport function notesBody(index, current) {\n  const notes = document.createElement('section');\n  notes.classList.add('_speaker-notes');\n\n  const currentSrc = buildNotesPreviewLink(index);\n\n  let nextSlideIndex = index + 1;\n\n  if (!current.next) {\n    nextSlideIndex--;\n  }\n\n  const nextSrc = buildNotesPreviewLink(nextSlideIndex, true);\n\n  notes.innerHTML = `<div class=\"_speaker-notes--current\"> <iframe src=\"${currentSrc}\" class=\"_speaker-notes--slide-preview\" frameborder=\"0\" height=\"1024\" width=\"1280\"></iframe> </div><div class=\"_speaker-notes--upcoming\"> <span class=\"_speaker-notes--label\">Upcoming:</span> <iframe src=\"${nextSrc}\" class=\"_speaker-notes--slide-preview\" frameborder=\"0\" height=\"1024\" width=\"1280\"></iframe> </div><div class=\"_speaker-notes--controls\"> <div class=\"controls\"> <div class=\"controls--time\"> <h4 class=\"controls--label\">Time <span class=\"controls--reset\">Click to Reset</span></h4> <button class=\"timer\"> <span class=\"timer--hours\">00</span><span class=\"timer--minutes\">:00</span><span class=\"timer--seconds\">:00</span> </button><div class=\"clock\"> <span class=\"clock--value\">0:00 AM</span> </div></div><div class=\"controls--position\"> <p class=\"controls--fragment\">Fragment <span class=\"controls--fragment-current\"></span>/<span class=\"controls--fragment-total\"></span></p><p class=\"controls--slide\">Step <span class=\"controls--slide-current\"></span>/<span class=\"controls--slide-total\"></span></p></div></div></div><article class=\"_speaker-notes--notes\"> <div class=\"slide-notes\"> <h4 class=\"slide-notes--label\">Notes</h4> <div class=\"slide-notes--content\"></div></div></article>`;\n\n  timing(notes);\n\n  return {\n    _notes: notes,\n    current: notes.querySelector('._speaker-notes--current ._speaker-notes--slide-preview'),\n    next: notes.querySelector('._speaker-notes--upcoming ._speaker-notes--slide-preview'),\n    content: notes.querySelector('.slide-notes--content'),\n    index: notes.querySelector('.controls--slide-current'),\n    total: notes.querySelector('.controls--slide-total'),\n    fragments: notes.querySelector('.controls--fragment'),\n    currentFrag: notes.querySelector('.controls--fragment-current'),\n    totalFrag: notes.querySelector('.controls--fragment-total'),\n  };\n}\n"],"names":["createPresentation","channel","window","BroadcastChannel","buildNotesPreviewLink","index","upcoming","locale","location","search","URLSearchParams","link","URL","origin","pathname","hash","set","toString","updateNotes","notes","current","content","innerHTML","textContent","hasOwnProperty","fragments","dataset","active","currentFrag","fragment","totalFrag","totalFragments","timing","parent","clock","querySelector","timer","hour","minute","second","start","Date","update","runningClock","setInterval","addEventListener","e","clearInterval","timePad","now","diff","getTime","hours","Math","floor","minutes","seconds","toLocaleTimeString","hour12","setAttribute","time","str","parseInt","substring","length","notesBody","document","createElement","classList","add","currentSrc","nextSlideIndex","next","nextSrc","_notes","total"],"mappings":"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"}